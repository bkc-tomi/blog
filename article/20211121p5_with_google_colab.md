---
title: "Google Colaboratoryでクリエイティブコーディング(Processing)をする方法"
date: "2021/11/21 20:48:41"
category: ""
topics: ["Google", "Colaboratory", "Processing", "Python", "環境構築", "クリエイティブコーディング"]
published: false
---

# きっかけ

この章はやろうと思ったきっかけについて書いてます。やり方だけを知りたい人は、「Google Colaboratoryを使用する」まで飛ばしてください。

## 最初に

来年度から本格的に高校の「情報」にもプログラミングの内容が入ってきます。大学共通テストでも疑似言語(DNCL)を使ったプログラミングの内容が入ってきて、進学校だから関係ないとは言っていられない状況になっています。

![擬似言語の例](https://github.com/bkc-tomi/blog/blob/main/src/nscl.jpeg?raw=true)

そんな中、私はpythonを授業で取り扱う言語として決めました。pythonはGoogle Colaboratoryを使うことでウェブ上で実行ができます。また、Google ColaboratoryはAIなどの技術を使うこともでき、本格的なプログラミングの活用も可能です。

今年は本格始動の来年に向けての実験段階だったのですが、やはりどうせやるならプログラミングの書き方だけではなく、活用のところまでさせてあげたいと思い、光学文字認識をさせようと思ったのですが、思ったよりもプログラミングの基本が身に付かず断念することにしました。

しかし、プログラミングが目的ではなく手段であることを考えると、プログラミングの書き方だけを理解して終わるのは納得いきませんでした。そこで目を付けたのがクリエイティブコーディングでした。

## クリエイティブコーディングとは

絵や音楽などアートと呼ばれるものをプログラミングで表現することをクリエイティブコーディングと言います。画面上のキャンバスのどこにどのような色でどのような図形を描くかをコンピュータに命令して、絵を描いていきます。私は、2, 3年前からクリエイティブコーディングにハマっていて、たまに描いていました。以下はその例です。

![クリエイティブコーディングの例](https://github.com/bkc-tomi/blog/blob/main/src/cc_images.png?raw=true)

クリエイティブコーディングは、コードを書いてコンピュータに絵を描かせます。コンピュータは計算機なので数学を活かしたこれまでにない表現が可能になります。例えば、例に挙げている下の３つは、力学におけるカオスを使いアレンジを加えることで独特の表現をしています。

また、動画はもちろん、マウスクリックなどのアクションに対して描画を変えることもできるので、インタラクションや簡易的なゲームを作ることも可能です。

集めたデータをオシャレに表現したり、高校で学んだ理系科目の内容を独自の解釈でビジュアライズしたりと生徒がプログラミングを楽しみつつ新しい発見ができることを期待してクリエイティブコーディングをやってみようと考えました。


## 何でクエイティブコーディングをするか

クリエイティブコーディングをするツールは色々ありますが、私は昔から使い慣れていて、pythonにも対応している **Processing** を使うことにしました。

https://processing.org/

しかし、このツールはインストール前提でありChromebookには対応していません。
JavaScriptを採用している学校でしたら **p5.js** というウェブアプリケーションがありますので、これを利用すると良いでしょう。しかしPythonにはこのようなサービスはありません。

https://p5js.org/

# Google Colaboratoryを使用する

## pyp5.js

困り果ててウェブで検索をしていると **pyp5js** というgithubリポジトリを見つけました。つたない英語力で読み進めると、どうやらpythonで書かれたProcessingのコードをブラウザ上で実行できるサーバをローカルホスト上に構築できるもののようです。

https://berinhard.github.io/pyp5js/

Google Colaboratoryはローカルホストにサーバを立てることができるのでこれを使ってpythonでクリエイティブコーディングをすることにしました。

## Google Colabでの作業

Google Colabでの作業は簡単です。 **pyp5js** がどのような仕組みで動いているかも気にする必要はありません。次の４つのステップをそれぞれのセルに記述するだけです。

- pyp5jsのインストール
- Googleドライブのマウント(データの保持が必要なければ飛ばしても良い)
- Google Colab上に立てたサーバをクライアントPCのブラウザからアクセスできるようにする
- サーバの起動

以下に書いているコードをGoogle Colabのそれぞれのセルに貼り付けて実行していってください。

### pyp5jsのインストール

```
# =================================================================
# pyp5jsのインストール
# =================================================================

!pip install pyp5js
```

### Googleドライブのマウント
これは、書いたコードを保存しておきたい時に、コードの出力先をGドライブにするために行います。実行するとドライブへのアクセス許可として少しめんどくさいことをする必要があります。

コードを保存しておく必要がない場合は飛ばしてください。


```python
# =================================================================
# Googleドライブのマウント(データの保持が必要なければ飛ばしても良い)
# =================================================================

from google.colab import drive
drive.mount('/content/drive')
```

### Google Colab上に立てたサーバをクライアントPCのブラウザからアクセスできるようにする
クライアントPCでpyp5jsを実行する場合は、`pyp5js serve`の実行結果に出てくるリンクからで良いのですが、Google Colabの場合は、こちらを実行して出てくるリンク(`https://localhost:5000`)からアクセスしないといけません(下の画像参照)。

```python
# =================================================================
# Google Colab上に立てたサーバをクライアントPCのブラウザからアクセスできるようにする
# =================================================================

PORT = 5000
PATH = ''

from google.colab import output
output.serve_kernel_port_as_window(PORT, path=PATH)
```

![実行例](https://github.com/bkc-tomi/blog/blob/main/src/screenshot_googleColab.png?raw=true)

### サーバの起動
Gドライブをマウントしてコードをを保存する場合は、コードの出力先を指定して実行してください。

`!SKETCHBOOK_DIR='../content/drive/Shareddrives/sketchbook' pyp5js serve`

この例では、共有ドライブのsketchbookというドライブを出力先にしています。
このドライブを生徒に共有することで、生徒が作成したデータを生徒どうしで共有できるようにする目的で、このようにしました。また、提出という面倒な作業も必要なくなります。

Gドライブのマウントをしていない場合はコメントアウトしている`pyp5js serve`の方を、コメントを外して実行してみてください。

```
# =================================================================
# サーバーの起動
# =================================================================

# データの保持が必要ない場合
# !pyp5js serve

# データの保持が必要な場合
!SKETCHBOOK_DIR='../content/drive/Shareddrives/sketchbook' pyp5js serve
```

## 実行結果

実行して`https://localhost:5000`にアクセスすると、以下のようなページが開きWeb上でpythonコードを書いてクリエイティブコーディングをすることができます。APIなどはp5jsのサイトの[リファレンス](https://p5js.org/reference/)を参考にすると良いと思います。

![最初の画面](https://github.com/bkc-tomi/blog/blob/main/src/screenshot_mainpage.png?raw=true)
![プロジェクト作成画面](https://github.com/bkc-tomi/blog/blob/main/src/screenshot_new_project_page.png?raw=true)
![コーディング画面](https://github.com/bkc-tomi/blog/blob/main/src/screenshot_playground.png?raw=true)

まだ授業では使っていませんが、授業で実践してみたら、その感想もこのブログに残したいと思います。